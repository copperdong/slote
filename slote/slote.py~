#! /usr/bin/python

import os
from scipy import misc
from sklearn import svm

def load_training():
    char_paths = [x[0] for x in os.walk('./training_data')][1:]
    char_library = [x[0][16:] for x in os.walk('./training_data')][1:]
    
    data = []
    targets = []
    for char in char_library:
        for fname in [x[2] for x in os.walk('training_data/' + char)][0]:
            data.extend(misc.imresize(misc.imread('training_data/' + char + '/' + fname, flatten = True), [320, 240]).reshape([1, 320 * 240]))
            targets.append(char)

    classifier = svm.SVC()
    classifier.fit(data, targets)

    return classifier

